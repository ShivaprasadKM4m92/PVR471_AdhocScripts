//# sourceMappingURL=emailAttachmentSplit.js.map
$(document).ready(function(){function f(){$("#emailAttachmentCheckboxAll").is(":checked")?($("#emailAttachmentAll").show(),$("#emailAttachmentSplit").hide(),additionalAttachments=[],$("#emailAttachmentsConfig").val(""),$(".attachmentTableRow").remove()):($("#emailAttachmentAll").hide(),$("#emailAttachmentSplit").show(),$("input[name=deliveryOption\\.attachmentFormats]").attr("checked",!1))}$(".emailAttachmentCheckbox").on("change",function(){f()});f();$("#emailAttachmentSplitFormat").select2({allowClear:!0});
$(".showAttachmentModalButton").on("click",function(){$("#addAttachmentModal").modal("show");for(var c="",e=$(".templateQuery-div:visible").find("input.selectTemplate"),a=0;a<e.length;a++)var g=$(e[a]).select2("data"),g=g.configureAttachments?g.configureAttachments:g.text,c=c+(" <div class=\"checkbox checkbox-primary\">\n<input type='checkbox' class='attachmentCheckbox' id='attachmentCheckbox"+a+"' value='"+a+"'><label for='attachmentCheckbox"+a+"'>"+$.i18n._("app.configuration.section")+" "+(a+1)+
" "+g+"</label></div> ");$("#attachmentModalContent").html(c);$(".attachmentFormatModal").attr("checked",!1)});$(document).on("click",".removeAttachmentTableRow",function(){var c=$(this).attr("data-id");additionalAttachments=_.filter(additionalAttachments,function(e){return e.id!=c});formAttachmentTable();$("#emailAttachmentsConfig").val(JSON.stringify(additionalAttachments))});$("#saveAttachmentButton").on("click",function(){var c=0;0<additionalAttachments.length&&(c=_.max(additionalAttachments,
function(a){return a.id}).id+1);var e=[];$("#attachmentModalContent").find(".attachmentCheckbox").each(function(){$(this).is(":checked")&&e.push($(this).val())});var a=[];$("#addAttachmentModal").find(".attachmentFormat").each(function(){$(this).is(":checked")&&a.push($(this).val())});0<e.length&&0<a.length?(additionalAttachments.push({id:c,sections:e,formats:a}),$("#emailAttachmentsConfig").val(JSON.stringify(additionalAttachments)),formAttachmentTable(),$("#addAttachmentModal").modal("hide")):$(".additionalAttachmentsDialogError").show()});
$("#cancelAttachmentButton").on("click",function(){$("#attachmentModalDialogError").hide()})});var additionalAttachments=null;
function formAttachmentTable(f){if(null==additionalAttachments){var c=$("#emailAttachmentsConfig").val();additionalAttachments=null!=c&&""!=c?JSON.parse(c):[]}var c=$(".templateQuery-div:visible").find("input.selectTemplate"),e=$(".emailAttachmentsTable");$(".attachmentTableRow").remove();var a=[];if(2>c.length)$("#emailAttachmentCheckboxAll").click(),$(".emailAttachmentCheckbox").attr("disabled",!0);else{$(".emailAttachmentCheckbox").attr("disabled",!1);for(var g=!1,b=0;b<additionalAttachments.length;b++){for(var h=
[],d=0;d<additionalAttachments[b].sections.length;d++)"undefined"==typeof f?h.push(additionalAttachments[b].sections[d]):parseInt(additionalAttachments[b].sections[d])!=parseInt(f)?h.push(additionalAttachments[b].sections[d]<parseInt(f)?additionalAttachments[b].sections[d]:additionalAttachments[b].sections[d]-1):g=!0;0<h.length&&a.push({id:additionalAttachments[b].id,sections:h,formats:additionalAttachments[b].formats})}additionalAttachments=a;$.isEmptyObject(additionalAttachments)||$("#emailAttachmentsConfig").val(JSON.stringify(additionalAttachments));
g&&$(".additionalAttachmentsWarning").show();for(b=0;b<additionalAttachments.length;b++){f="";for(d=0;d<additionalAttachments[b].sections.length;d++)a=$(c[additionalAttachments[b].sections[d]]).select2("data"),a=a.configureAttachments?a.configureAttachments:a.text,f+=$.i18n._("app.configuration.section")+" "+(1+parseInt(additionalAttachments[b].sections[d]))+": "+a+"<br>";d="<tr class='attachmentTableRow'><td><span class='table-remove glyphicon glyphicon-remove removeAttachmentTableRow' data-id='"+
additionalAttachments[b].id+"'></span></td>\n<td>"+additionalAttachments[b].formats.join(",")+"</td><td>"+f+"</td></tr>";e.append(d)}}};