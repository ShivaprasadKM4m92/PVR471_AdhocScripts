//# sourceMappingURL=grouped-categories.js.map
(function(d){"object"===typeof module&&module.exports?module.exports=d:d(Highcharts)})(function(d){function y(a,b){this.userOptions=JSON.parse(JSON.stringify(a));this.name=a.name||a;this.parent=b;return this}function B(a){for(var b=a.length,c=0;b--;)c+=a[b];return c}function C(a,b,c,l,f){var d=a.length,p;f=f?f:0;for(c.depth=c.depth?c.depth:0;d--;)if(p=a[d],p.categories)l&&(p.parent=l),C(p.categories,b,c,p,f+1);else{var g=l;for(b.unshift(new y(p,g));g;)g.leaves=g.leaves?g.leaves+1:1,g=g.parent}c.depth=
z(c.depth,f)}function v(a,b,c){b[0]===b[2]&&(b[0]=b[2]=D(b[0])-c%2/2);b[1]===b[3]&&(b[1]=b[3]=D(b[1])+c%2/2);a.push("M",b[0],b[1],"L",b[2],b[3])}function A(a,b){return a.getPosition(a.axis.horiz,b,a.axis.tickmarkOffset)}function w(a,b,c){for(var l=a.length,f;l--;)(f=a[l][b])&&w(f,b,c),c(a[l])}var D=Math.round,G=Math.min,z=Math.max,x=d.merge,E=d.pick,H=d.each,I=window.HighchartsAdapter&&window.HighchartsAdapter.inArray||d.inArray,m=d.Axis.prototype;d=d.Tick.prototype;var J=m.init,K=m.render,L=m.setCategories,
F=d.getLabelSize,M=d.addLabel,N=d.destroy,O=d.render;y.prototype.toString=function(){for(var a=[],b=this;b;)a.push(b.name),b=b.parent;return a.join(", ")};m.init=function(a,b){J.call(this,a,b);"object"===typeof b&&b.categories&&this.setupGroups(b)};m.setupGroups=function(a){var b=JSON.parse(JSON.stringify(a.categories)),c=[],l={},f=this.options.labels,d=f.groupedOptions,f=f.style;C(b,c,l);this.categoriesTree=b;this.categories=c;this.isGrouped=0!==l.depth;this.labelsDepth=l.depth;this.labelsSizes=
[];this.labelsGridPath=[];this.tickLength=a.tickLength||this.tickLength||null;this.tickWidth=E(a.tickWidth,this.isXAxis?1:0);this.directionFactor=[-1,1,1,-1][this.side];this.options.lineWidth=E(a.lineWidth,1);this.groupFontHeights=[];for(a=0;a<=l.depth;a++)b=d&&d[a-1]&&d[a-1].style?x(f,d[a-1].style):f,this.groupFontHeights[a]=Math.round(.3*this.chart.renderer.fontMetrics(b?b.fontSize:0).b)};m.render=function(){this.isGrouped&&(this.labelsGridPath=[]);void 0===this.originalTickLength&&(this.originalTickLength=
this.options.tickLength);this.options.tickLength=this.isGrouped?.001:this.originalTickLength;K.call(this);if(!this.isGrouped)return this.labelsGrid&&this.labelsGrid.attr({visibility:"hidden"}),!1;var a=this,b=a.options,c=a.top,l=a.left,f=l+a.width,d=c+a.height,p=a.hasVisibleSeries||a.hasData,g=a.labelsDepth,r=a.labelsGrid,k=a.horiz,n=a.labelsGridPath,e=!1===b.drawHorizontalBorders?g+1:0,h=a.opposite?k?c:f:k?d:l,u=a.tickWidth;a.userTickLength&&--g;r||(r=a.labelsGrid=a.chart.renderer.path().attr({strokeWidth:u,
"stroke-width":u,stroke:b.tickColor||""}).add(a.axisGroup),b.tickColor||r.addClass("highcharts-tick"));for(;e<=g;)h+=a.groupSize(e),b=k?[l,h,f,h]:[h,c,h,d],v(n,b,u),e++;r.attr({d:n,visibility:p?"visible":"hidden"});a.labelGroup.attr({visibility:p?"visible":"hidden"});w(a.categoriesTree,"categories",function(b){b=b.tick;if(!b)return!1;b.startAt+b.leaves-1<a.min||b.startAt>a.max?(b.label.hide(),b.destroyed=0):b.label.attr({visibility:p?"visible":"hidden"});return!0});return!0};m.setCategories=function(a,
b){this.categories&&this.cleanGroups();this.setupGroups({categories:a});this.categories=this.userOptions.categories=a;L.call(this,this.categories,b)};m.cleanGroups=function(){var a=this.ticks,b;for(b in a)a[b].parent&&delete a[b].parent;w(this.categoriesTree,"categories",function(a){var b=a.tick;if(!b)return!1;b.label.destroy();H(b,function(a,c){delete b[c]});delete a.tick;return!0});this.labelsGrid=null};m.groupSize=function(a,b){var c=this.labelsSizes,d=this.directionFactor,f=this.options.labels.groupedOptions?
this.options.labels.groupedOptions[a-1]:!1,m=0;f&&(m=-1===d?f.x?f.x:0:f.y?f.y:0);void 0!==b&&(c[a]=z(c[a]||0,b+10+Math.abs(m)));return!0===a?B(c)*d:c[a]?c[a]*d:0};d.addLabel=function(){var a;M.call(this);if(!this.axis.categories||!(a=this.axis.categories[this.pos]))return!1;this.label&&this.label.attr("text",this.axis.labelFormatter.call({axis:this.axis,chart:this.axis.chart,isFirst:this.isFirst,isLast:this.isLast,value:a.name}));this.axis.isGrouped&&this.axis.options.labels.enabled&&this.addGroupedLabels(a);
return!0};d.addGroupedLabels=function(a){for(var b=this,c=this.axis,d=c.chart,f=c.options.labels,m=f.useHTML,p=f.style,g=f.groupedOptions,r={align:"center",rotation:f.rotation,x:0,y:0},k=c.horiz?"height":"width",n=0,e;b;){if(0<n&&!a.tick){this.value=a.name;e=f.formatter?f.formatter.call(this,a):a.name;var h=g&&g[n-1],u=h?x(r,g[n-1]):r,h=h&&g[n-1].style?x(p,g[n-1].style):p;delete u.style;e=d.renderer.text(e,0,0,m).attr(u).css(h).add(c.labelGroup);b.startAt=this.pos;b.childCount=a.categories.length;
b.leaves=a.leaves;b.visible=this.childCount;b.label=e;b.labelOffsets={x:u.x,y:u.y};a.tick=b}b&&c.groupSize(n,b.label.getBBox()[k]);b=(a=a.parent)?b.parent=a.tick||{}:null;n++}};d.render=function(a,b,c){O.call(this,a,b,c);a=this.axis.categories[this.pos];if(this.axis.isGrouped&&a&&!(this.pos>this.axis.max)){b=this;c=this.axis;var d=this.pos,f=this.isFirst,m=c.max,p=c.min,g=c.horiz,r=c.labelsGridPath,k=c.groupSize(0),n=c.tickWidth,e=A(this,d),h=g?e.y:e.x,d=c.chart.renderer.fontMetrics(c.options.labels.style?
c.options.labels.style.fontSize:0).b,u=1,q=g&&e.x===c.pos+c.len||!g&&e.y===c.pos?-1:0,t,w;f&&(t=g?[c.left,e.y,c.left,e.y+c.groupSize(!0)]:c.isXAxis?[e.x,c.top,e.x+c.groupSize(!0),c.top]:[e.x,c.top+c.len,e.x+c.groupSize(!0),c.top+c.len],v(r,t,n));g&&c.left<e.x?v(r,[e.x-q,e.y,e.x-q,e.y+k],n):!g&&c.top<=e.y&&v(r,[e.x,e.y+q,e.x+k,e.y+q],n);for(k=h+k;b.parent;){b=b.parent;q=0;f&&(q=I(a.name,a.parent.categories),q=0>q?0:q);var x=b.labelOffsets.x,y=b.labelOffsets.y,h=A(this,z(b.startAt-1,p-1));t=A(this,
G(b.startAt+b.leaves-1-q,m));w=b.label.getBBox(!0);e=c.groupSize(u);q=g&&t.x===c.pos+c.len||!g&&t.y===c.pos?-1:0;h=g?{x:(h.x+t.x)/2+x,y:k+c.groupFontHeights[u]+e/2+y/2}:{x:k+e/2+x,y:(h.y+t.y-w.height)/2+d+y};isNaN(h.x)||isNaN(h.y)||(b.label.attr(h),r&&(g&&c.left<t.x?v(r,[t.x-q,k,t.x-q,k+e],n):!g&&c.top<=t.y&&v(r,[k,t.y+q,k+e,t.y+q],n)));k+=e;u++}}};d.destroy=function(){for(var a=this.parent;a;)a.destroyed=a.destroyed?a.destroyed+1:1,a=a.parent;N.call(this)};d.getLabelSize=function(){if(!0===this.axis.isGrouped){var a=
F.call(this)+10;this.axis.labelsSizes[0]<a&&(this.axis.labelsSizes[0]=a);return B(this.axis.labelsSizes)}return F.call(this)}});