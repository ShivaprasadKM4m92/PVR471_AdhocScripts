//# sourceMappingURL=emailModal.js.map
$(document).ready(function(){function g(a){var c=$("#emailCopyPasteWarn"),b=$("#emailCopyPasteWarnContent"),d=[];b.html("");$("#emailUsers").find("option").each(function(){d.push($(this).val())});return(a=_.difference(a,d))&&0<a.length?(_.each(a,function(a){""===b.html()?b.html($.i18n._("email.not.exist")+"<br><div class='row'><div class='col-sm-6'><label>"+$.i18n._("email.description.field")+"</label></div><div  class='col-sm-6'><label>"+$.i18n._("email")+"</label></div></div>"+f(a)):b.html(b.html()+
f(a))}),b.html(b.html()+"<div class='row'><div class='col-sm-5'></div><div class='col-sm-2' id='emailCopyPasteSaveLoading'>&nbsp;</div><div class='col-sm-5'  style='text-align: right'><input type='button' value='"+$.i18n._("save")+"' class='btn btn-success emailCopyPasteSave'> </div></div>"),c.show(),$(".confirm-paste-email-values").prop("disabled",!0),!1):!0}function f(a){return"<div class='row'><div class='col-sm-6'><input class='form-control emailsToAdd' data-email='"+a+"' value='"+a+"'></div><div  class='col-sm-6'><input class='form-control ' disabled value='"+
a+"'></div></div>"}function h(a){var c=$("#emailCopyPasteError"),b=$("#emailCopyPasteErrorContent");c.hide();b.html("");_.each(a,function(a){isEmail(a)||(""===b.html()?b.html($.i18n._("email.not.valid.error")+" "+encodeToHTML(a)):b.html(b.html()+", "+a))});return""!==b.html()?(c.show(),!1):!0}function k(a){var c=$(a).find("input:radio[name^=delimiter]:checked").val();return"none"===c?null:"others"===c?(a=$(a).find(".c_n_p_other_delimiter").val(),_.isEmpty(a)?null:a):c}var e;$(document).on("click",
".copyPasteEmailButton",function(a){$("#emailCopyPasteWarn").hide();$(".confirm-paste-email-values").prop("disabled",!1);$copyAndPasteEmailModal=$("#copyAndPasteEmailModal");e=$(this).parent().find("select");(a=e.select2("val"))&&0<a.length?($copyAndPasteEmailModal.find(".copyPasteContent").val(a.join(";")),$("#semicolon-delimiter").prop("checked",!0)):$copyAndPasteEmailModal.find(".copyPasteContent").val("");$copyAndPasteEmailModal.modal("show")});$(document).on("input propertychange",".copyPasteContent",
function(a){$(".confirm-paste-email-values").prop("disabled",!1);$("#emailCopyPasteWarn").hide()});$(document).on("input propertychange",".c_n_p_other_delimiter",function(a){$(".confirm-paste-email-values").prop("disabled",!1);$("#emailCopyPasteWarn").hide()});$(document).on("change","input:radio[name^=delimiter]",function(a){$(".confirm-paste-email-values").prop("disabled",!1);$("#emailCopyPasteWarn").hide()});$(document).on("click",".confirm-paste-email-values",function(a){a.preventDefault();a=
$("#copyAndPasteEmailModal");delimiter=k(a);var c=a.find(".copyPasteContent").val();null!==delimiter&&("|"===delimiter&&(delimiter="\\|"),"\\n"===delimiter&&(delimiter="\n"));null===c||_.isEmpty(c)||(c=_.without(_.uniq(_.map(c.split(delimiter),function(a){return a.trim()})),""),h(c)&&g(c)&&(e.val(c).trigger("change"),a.modal("hide"),$("#emailCopyPasteWarn").hide()))});$(document).on("click",".emailCopyPasteSave",function(a){var c=[];a=$(".emailsToAdd");for(var b=0;b<a.length;b++){var d=$(a[b]),e=
d.val();if(""===e){d.css("border-color","#a94442");setTimeout(function(){d.css("border-color","#ccc")},2E3);return}c.push({email:encodeToHTML(d.attr("data-email")),description:e})}$(".confirm-paste-email-values").prop("disabled",!0);$(".emailCopyPasteSave").prop("disabled",!0);$("#emailCopyPasteSaveLoading").addClass("small-loading");$.ajax({url:emailAddAllUrl,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(c),success:function(a){$(".emailUsers").each(function(a,
b){"SELECT"==b.tagName&&_.each(c,function(a){$("<option value='"+a.email+"'>"+a.description+" - "+a.email+"</option>").appendTo($(b))})});$("#emailCopyPasteWarnContent").html("<b>"+$.i18n._("email.successfully.added")+"</b>");$(".confirm-paste-email-values").prop("disabled",!1)},error:function(a){errorNotification((a.responseJSON.message?a.responseJSON.message:"")+(a.responseJSON.stackTrace?"<br>"+a.responseJSON.stackTrace:""))}})});$("#cancelBtn").click(function(){$(".alert-danger").addClass("hide")})});